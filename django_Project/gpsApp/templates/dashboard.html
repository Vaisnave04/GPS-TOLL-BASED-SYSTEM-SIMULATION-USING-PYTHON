<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    <title>Dashboard</title>
    <link rel="stylesheet" type="text/css" media="screen" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/fontawesome.js' %}" ></script>
    <script src="{% static 'js/jquery-3.6.0.min.js' %}" ></script>
    <style>
        /* General styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .dashboard-container {
            max-width: 100%;
            background: #fff;
            padding: 4px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .stat-item {
            background: #f4f4f4;
            padding: 20px;
            border-radius: 100px;
            text-align: center;            
            width: 100%;
            font-family: Arial, sans-serif;
            font-style: normal;
            color: #000;
        }
        .charts {
            margin-top: 20px;
            padding-top: 50px;
        }
        .recent-trips {
            padding-top: 50px;
        }
        .recent-trips table {
            width: 100%;
            border-collapse: collapse;
        }
        .recent-trips th, .recent-trips td {
            border: 1px solid #ddd;
            padding: 16px;
        }
        .recent-trips th {
            background: #f4f4f4;
        }
        .highcharts-figure,
.highcharts-data-table table {
    min-width: 310px;
    max-width: 800px;
    margin: 1em auto;
}

#container {
    height: 400px;
}

.highcharts-data-table table {
    font-family: Verdana, sans-serif;
    border-collapse: collapse;
    border: 1px solid #ebebeb;
    margin: 10px auto;
    text-align: center;
    width: 100%;
    max-width: 500px;
}

.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}

.highcharts-data-table th {
    font-weight: 600;
    padding: 0.5em;
}

.highcharts-data-table td,
.highcharts-data-table th,
.highcharts-data-table caption {
    padding: 0.5em;
}

.highcharts-data-table thead tr,
.highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}

.highcharts-data-table tr:hover {
    background: #f1f7ff;
}
    </style>
   <script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Fetch the data for the chart
            fetch('{% url "chart_data" %}')
                .then(response => response.json())
                .then(data => {
                    // Use the data to render a Highchart
                    Highcharts.chart('highchart_container', {
                        chart: {
                            type: 'column'
                        },
                        title: {
                            text: 'Monthly Data'
                        },
                        xAxis: {
                            categories: data.categories
                        },
                        yAxis: {
                            title: {
                                text: 'Values'
                            }
                        },
                        series: [{
                            name: 'Data',
                            data: data.data
                        }]
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
        });

    </script>
</head>
<body>{% block content %}
    <div class="table-container">
        {% csrf_token %}
<table border=0 cellspacing=0 cellpadding=0 width="100%">
    
    <tr>
        <td nowrap>
            <div class="stats">
                <table border="0" cellspacing="0" cellpadding="3" width="100%">
                    <tr>
                        <td >
                            <div class="stat-item">
                                <h2>Total Trips</h2>
                                <p>{{ context.aggregate_data.num_trips }}</p>
                            </div>
                        </td>
                        <td>&nbsp;</td>
                        <td>
                            <div class="stat-item">
                                <h2>Total Distance</h2>
                                <p>{{ context.aggregate_data.total_distance }}</p>
                            </div>
                        </td>
                        <td>&nbsp;</td>
                        <td>
                            <div class="stat-item">
                                <h2>Total Payments</h2>
                                <p>{{ context.aggregate_data.total_amount }}</p>
                            </div>
                        </td>
                        
                    </tr>
                </table>
                
            </div>
        </td>
    </tr>
    <tr><td>dddd</td></tr>
<tr><td><div class="">
    <div class="container" id="recent-recent-trips">
        
        <table>
            <thead>
                <tr class="dataGridColor">
                    <th colspan="8" align="center"><h2>Recent Trip List</h2></th>
                </tr>
            </thead>
                <thead>
                    <tr class="dataGridColor">
                        <th  >Date</th>
                        <th class="black-font" >Source</th>
                        <th class="black-font" >Destination</th>
                        <th class="black-font" >Distance</th>
                    </tr>
                </thead>
                <tbody>
                    {% for trip in context.trips %}
                        <tr class="dataGridColor">
                            <td>{{ trip.trip_date }}</td>
                            <td>{{ trip.source }}</td>
                            <td>{{ trip.destination }}</td>
                            <td>{{ trip.distance }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tbody>
                    <tr><td colspan="7" align="right">
                        <div class="pagination" id="pagination">
                          <button id="prev">Previous</button>
                          <span id="page-info"></span>
                          <button id="next">Next</button>
                        </div></td></tr>
                </tbody>
            </table>
            </table>
          
    </div>
 </div></td></tr></td></tr>
<tr><td> <div class="charts">
    <h2>Trips Over Time</h2>
    <div id="highchart_container" style="width: 100%; height: 400px;"></div>
</div></td></tr></table></div>
       
   
    {% endblock %}
</body>
</html>
